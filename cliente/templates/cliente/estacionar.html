{% extends 'cliente/base_clientes.html' %}
{% load static %}

{% block content %}
    <div class="vehicle_type_estacionar">
        <div class="vehicle_type">
        <h2>Tipo de Veículo:</h2>
            <button class='btn-vehicle-type btn-active' id='btn-type-all'><img src="{% static 'imagens/img_carro_az.png' %}" alt="Todos" id="car">Todos</button>
            {% include 'partials/_vehicle_type.html' %}
    </div>
    <div class="vehicle_plate_estacionar">
        <h2 class="vehicle_plate_title">Veículos:</h2>
        <div id='vehiclesDiv'>
        
        {% for car in cars %}
            <button class="btn_vehicle_plate btn-car" onclick="btnActive(this)"><img src="{% static 'imagens/img_carro_az.png' %}" alt="Carro Azul" id="car">{{car}}</button>
        {% endfor %}
        
        {% for moto in motos %}
            <button class="btn_vehicle_plate btn-moto" onclick="btnActive(this)"><img src="{% static 'imagens/img_moto_az.png' %}" alt="Carro Azul" id="car">{{moto}}</button>
        {% endfor %}

        {% for other in others %}
            <button class="btn_vehicle_plate btn-other" onclick="btnActive(this)"><img src="{% static 'imagens/img_demais_az.png' %}" alt="Carro Azul" id="car">{{other}}</button>
        {% endfor %}
        
        </div>
    </div>

    <div class="time">
        {% include 'partials/_time.html' %}
        <!-- <h1>TOTAL</h1> -->
        <div class="total">
            <h1>TOTAL</h1>
            <div class="div-total">

                <div class="div-total-informations">
                    <h2>Tempo:</h2>
                    <div class="informations">
                        <img src="{% static 'imagens/relogio.png' %}" alt="stylesheet">
                        <div class="box">
                            <p class="total-tempo">0min</p>
                        </div>
                    </div>
                </div>

                <div class="div-total-informations">
                    <h2>Valor:</h2>
                    <div class="informations">
                        <img src="{% static 'imagens/valor.png' %}" alt="stylesheet">
                        <div class="box">
                            <p class="total-value">R$ 0,00</p>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
<!-- 
    <div class="total">
        <div class="div-total">
            <h1>TOTAL</h1>
            <h2>Tempo:</h2>
            <div class="informations">
                <img src="{% static 'imagens/relogio.png' %}" alt="stylesheet">
                <div class="box">
                    <p class="total-tempo">0min</p>
                </div>
            </div>
            <h2>Valor:</h2>
            <div class="informations">
                <img src="{% static 'imagens/valor.png' %}" alt="stylesheet">
                <div class="box">
                    <p class="total-value">R$ 0,00</p>
                </div>
            </div>
        </div>
    </div> -->

    <div class="button_confirm">
        <button>Confirmar</button>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        let pageTitle = document.getElementById('page-title')
        pageTitle.innerHTML = 'Estacionar'

        /* Botões Tipo de Veículo e Veículo */
        let btnAll = document.getElementById('btn-type-all')
        let btnCar = document.getElementById('btn-type-car')
        let btnMoto = document.getElementById('btn-type-moto')
        let btnOther = document.getElementById('btn-type-other')

        let allVehicles = document.getElementsByClassName('btn_vehicle_plate')
        let cars = document.getElementsByClassName('btn-car')
        let motos = document.getElementsByClassName('btn-moto')
        let others = document.getElementsByClassName('btn-other')

        /* Botões Adicionando Tempo */
        let displayTimeValue1 = document.querySelector('#estacionar-value1')
        let displayTimeValue2 = document.querySelector('#estacionar-value2')
        let displayTempo = document.querySelector('.total-tempo')
        let displayValue = document.querySelector('.total-value')

        let totalTempo = 0
        let totalValue = 0
        let valorVeiculo1 = 0
        let valorVeiculo2 = 0
        let tipoVeiculo = ''

        function showHideVehicles(vehicles1, vehicles2, vehicles3) {
            for (let vehicle of vehicles1) {
                vehicle.style.display = 'none'
            }
            for (let vehicle of vehicles2) {
                vehicle.style.display = 'none'
            }
            for (let vehicle of vehicles3) {
                vehicle.style.display = 'inline-block'
            }
        }


        function showAllVehicles(vehicles) {
            for (let vehicle of vehicles) {
                vehicle.style.display = 'inline-block'
            }
        }


        function btnActive(botao) {
            totalTempo = 0
            totalValue = 0
            displayTempo.innerHTML = `${totalTempo}min`
            displayValue.innerHTML = `R$ ${totalValue.toFixed(2)}`
            for (let vehicle of allVehicles) {
                vehicle.classList.remove('btn-active')
            }
            botao.classList.add('btn-active')
            if (botao.classList.contains('btn-car') || botao.classList.contains('btn-other')) {
                valorVeiculo1 = 1.50
                valorVeiculo2 = 3
                tipoVeiculo = 'car or other' 
                displayTimeValue1.innerHTML = `R$ ${valorVeiculo1.toFixed(2)}`
                displayTimeValue2.innerHTML = `R$ ${valorVeiculo2.toFixed(2)}`
            }
            if (botao.classList.contains('btn-moto')) {
                valorVeiculo1 = 0.75
                valorVeiculo2 = 1.5
                tipoVeiculo = 'moto' 
                displayTimeValue1.innerHTML = `R$ ${valorVeiculo1.toFixed(2)}`
                displayTimeValue2.innerHTML = `R$ ${valorVeiculo2.toFixed(2)}`
            }
        }

        
        function deactivateVehiclesButtons() {
            for (let vehicle of allVehicles) {
                vehicle.classList.remove('btn-active')
                valorVeiculo1 = 0
                valorVeiculo2 = 0
                tipoVeiculo = '' 
                displayTimeValue1.innerHTML = `R$ ${valorVeiculo1.toFixed(2)}`
                displayTimeValue2.innerHTML = `R$ ${valorVeiculo2.toFixed(2)}`
            }
        }


        btnAll.onclick = function() {
            deactivateVehiclesButtons()
            btnCar.classList.remove('btn-active')
            btnMoto.classList.remove('btn-active')
            btnOther.classList.remove('btn-active')
            btnAll.classList.add('btn-active')
            showAllVehicles(allVehicles)
        }

        btnCar.onclick = function() {
            deactivateVehiclesButtons()
            btnAll.classList.remove('btn-active')
            btnMoto.classList.remove('btn-active')
            btnOther.classList.remove('btn-active')
            btnCar.classList.add('btn-active')
            showHideVehicles(motos, others, cars)
        }

        btnMoto.onclick = function(){
            deactivateVehiclesButtons()
            btnAll.classList.remove('btn-active')
            btnCar.classList.remove('btn-active')
            btnOther.classList.remove('btn-active')
            btnMoto.classList.add('btn-active')
            showHideVehicles(cars, others, motos)
        }

        btnOther.onclick = function(){
            deactivateVehiclesButtons()
            btnAll.classList.remove('btn-active')
            btnCar.classList.remove('btn-active')
            btnMoto.classList.remove('btn-active')
            btnOther.classList.add('btn-active')
            showHideVehicles(cars, motos, others)
        }


        function aumentarTempo(valorTempo, valorReais){
            if (tipoVeiculo != '') {
                totalTempo += valorTempo
                if (valorReais == 'Tarifa Menor') {totalValue += valorVeiculo1}
                else if (valorReais == 'Tarifa Maior') {totalValue += valorVeiculo2}
                displayTempo.innerHTML = `${totalTempo}min`
                displayValue.innerHTML = `R$ ${totalValue.toFixed(2)}`
            }
        }


        function reduzirTempo(valorTempo, valorReais){
            if (tipoVeiculo != '') {
                totalTempo -= valorTempo
                if (totalTempo < 0) totalTempo = 0
                if (valorReais == 'Tarifa Menor') {totalValue -= valorVeiculo1}
                else if (valorReais == 'Tarifa Maior') {totalValue -= valorVeiculo2}
                if (totalValue < 0) totalValue = 0 
                displayTempo.innerHTML = `${totalTempo}min`
                displayValue.innerHTML = `R$ ${totalValue.toFixed(2)}`
            }
        }

    </script>
{% endblock %}